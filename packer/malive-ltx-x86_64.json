{
    "variables": {
        "ssh_name": "user",
        "ssh_pass": "live",
        "ma_version": "@MA_VERSION@",
        "ma_checksum": "@MA_CHECKSUM@"
    },

    "builders": [{
        "type": "virtualbox-iso",
        "format": "ova",
        "guest_os_type": "Debian_64",
	"vm_name": "MateriAppsLive-ltx-{{user `ma_version`}}-x86_64",

        "vboxmanage": [
            ["modifyvm", "{{.Name}}", "--vram", "32"],
            ["modifyvm", "{{.Name}}", "--clipboard", "bidirectional"],
            ["modifyvm", "{{.Name}}", "--usb", "on"],
            ["modifyvm", "{{.Name}}", "--memory", "1000"]
        ],

        "iso_url": "malive/MateriAppsLive-{{user `ma_version`}}-x86_64.hybrid.iso",
        "iso_checksum": "{{user `ma_checksum`}}",
        "iso_checksum_type": "md5",

        "http_directory" : "malive",

        "ssh_username": "{{user `ssh_name`}}",
        "ssh_password": "{{user `ssh_pass`}}",
        "ssh_wait_timeout": "20m",

        "shutdown_command": "echo {{user `ssh_pass`}} | sudo -S shutdown -hP now",

        "boot_command" : [
            "<esc><wait>",
            "/install/vmlinuz initrd=/install/initrd.gz vga=788 ",
            "auto=true ",
            "netcfg/get_domain=local ",
            "netcfg/get_hostname=malive ",
            "url=http://{{ .HTTPIP }}:{{ .HTTPPort }}/preseed.cfg ",
            "<enter><wait>"
        ]
    }],

    "provisioners": [
	{
	    "type": "shell",
	    "inline": ["apt-get -y install texlive-lang-cjk"],
	    "execute_command": "echo {{user `ssh_pass`}} | {{ .Vars }} sudo -E -S sh '{{ .Path }}'"
	}
    ]
}
